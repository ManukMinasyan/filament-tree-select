var di=Object.defineProperty,ui=(e,t,s)=>t in e?di(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,o=(e,t,s)=>(ui(e,typeof t!="symbol"?t+"":t,s),s),Gt=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)},l=(e,t,s)=>(Gt(e,t,"read from private field"),s?s.call(e):t.get(e)),h=(e,t,s)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,s)},v=(e,t,s,i)=>(Gt(e,t,"write to private field"),i?i.call(e,s):t.set(e,s),s),a=(e,t,s)=>(Gt(e,t,"access private method"),s),$t={arrowUp:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 15l-6-6-6 6"/></svg>',arrowDown:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 9l6 6 6-6"/></svg>',arrowRight:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18l6-6-6-6"/></svg>',attention:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>',clear:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>',cross:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>',check:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>',partialCheck:'<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 25 25" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"></line></svg>'},H=(e,t)=>{if(t.innerHTML="",typeof e=="string")t.innerHTML=e;else{let s=e.cloneNode(!0);t.appendChild(s)}},Dt=e=>{let t=e?{...e}:{};return Object.keys($t).forEach(s=>{t[s]||(t[s]=$t[s])}),t},pi=e=>e.reduce((t,{name:s},i)=>(t+=s,i<e.length-1&&(t+=", "),t),""),M,T,F,W,_e,Gs,j,Q,We,qt,Te,jt,R,Z,V,D,Oe,Is,Ne,Rt,Ae,$s,Pe,Ut,Be,Ft,He,zt,Me,Yt,Ve,Jt,Ge,Ds,Ie,Kt,$e,Xt,De,qs,qe,Qt,je,Zt,Re,es,Ue,ts,se,Fe,ze=class{constructor({value:t,showTags:s,tagsCountText:i,clearable:n,isAlwaysOpened:c,searchable:r,placeholder:p,disabled:C,isSingleSelect:b,id:g,ariaLabel:E,iconElements:S,inputCallback:y,searchCallback:O,openCallback:x,closeCallback:z,keydownCallback:G,focusCallback:Y,blurCallback:m,nameChangeCallback:f}){h(this,_e),h(this,j),h(this,We),h(this,Te),h(this,R),h(this,V),h(this,Oe),h(this,Ne),h(this,Ae),h(this,Pe),h(this,Be),h(this,He),h(this,Me),h(this,Ve),h(this,Ge),h(this,Ie),h(this,$e),h(this,De),h(this,qe),h(this,je),h(this,Re),h(this,Ue),h(this,se),o(this,"value"),o(this,"showTags"),o(this,"tagsCountText"),o(this,"clearable"),o(this,"isAlwaysOpened"),o(this,"searchable"),o(this,"placeholder"),o(this,"disabled"),o(this,"isSingleSelect"),o(this,"id"),o(this,"ariaLabel"),o(this,"iconElements"),o(this,"isOpened"),o(this,"searchText"),o(this,"srcElement"),h(this,M,void 0),h(this,T,void 0),h(this,F,void 0),h(this,W,void 0),o(this,"inputCallback"),o(this,"searchCallback"),o(this,"openCallback"),o(this,"closeCallback"),o(this,"keydownCallback"),o(this,"focusCallback"),o(this,"blurCallback"),o(this,"nameChangeCallback"),this.value=t,this.showTags=s,this.tagsCountText=i,this.searchable=r,this.placeholder=p,this.clearable=n,this.isAlwaysOpened=c,this.disabled=C,this.isSingleSelect=b,this.id=g,this.ariaLabel=E,this.iconElements=S,this.isOpened=!1,this.searchText="",v(this,M,a(this,Ae,$s).call(this)),v(this,T,a(this,Ge,Ds).call(this)),v(this,F,a(this,De,qs).call(this)),v(this,W,null),this.inputCallback=y,this.searchCallback=O,this.openCallback=x,this.closeCallback=z,this.keydownCallback=G,this.focusCallback=Y,this.blurCallback=m,this.nameChangeCallback=f,this.srcElement=a(this,Oe,Is).call(this,l(this,M),l(this,T),l(this,F)),a(this,_e,Gs).call(this)}focus(){setTimeout(()=>l(this,T).focus(),0)}blur(){this.isOpened&&a(this,V,D).call(this),this.clearSearch(),l(this,T).blur()}updateValue(t){this.value=t,a(this,j,Q).call(this),a(this,R,Z).call(this)}removeItem(t){this.value=this.value.filter(s=>s.id!==t),a(this,se,Fe).call(this),a(this,j,Q).call(this),a(this,R,Z).call(this)}clear(){this.value=[],a(this,se,Fe).call(this),a(this,j,Q).call(this),this.clearSearch()}openClose(){a(this,V,D).call(this)}clearSearch(){this.searchText="",this.searchCallback(""),a(this,R,Z).call(this)}};M=new WeakMap,T=new WeakMap,F=new WeakMap,W=new WeakMap,_e=new WeakSet,Gs=function(){a(this,j,Q).call(this),a(this,R,Z).call(this),a(this,We,qt).call(this)},j=new WeakSet,Q=function(){if(l(this,M).innerHTML="",this.showTags){l(this,M).append(...a(this,Pe,Ut).call(this));let e=pi(this.value);this.nameChangeCallback(e)}else{let e=a(this,Ve,Jt).call(this);l(this,M).appendChild(e),this.nameChangeCallback(e.innerText)}l(this,M).appendChild(l(this,T))},We=new WeakSet,qt=function(){let e=[];l(this,F).innerHTML="",this.clearable&&e.push(a(this,qe,Qt).call(this)),this.isAlwaysOpened||e.push(a(this,Re,es).call(this,this.isOpened)),e.length&&l(this,F).append(...e)},Te=new WeakSet,jt=function(){if(!this.isAlwaysOpened&&l(this,W)){let e=this.isOpened?this.iconElements.arrowUp:this.iconElements.arrowDown;H(e,l(this,W))}},R=new WeakSet,Z=function(){var e;(e=this.value)!=null&&e.length?(l(this,T).removeAttribute("placeholder"),this.srcElement.classList.remove("treeselect-input--value-not-selected")):(l(this,T).setAttribute("placeholder",this.placeholder),this.srcElement.classList.add("treeselect-input--value-not-selected")),this.searchable?this.srcElement.classList.remove("treeselect-input--unsearchable"):this.srcElement.classList.add("treeselect-input--unsearchable"),this.isSingleSelect?this.srcElement.classList.add("treeselect-input--is-single-select"):this.srcElement.classList.remove("treeselect-input--is-single-select"),l(this,T).value=this.searchText},V=new WeakSet,D=function(){this.isOpened=!this.isOpened,a(this,Te,jt).call(this),this.isOpened?this.openCallback():this.closeCallback()},Oe=new WeakSet,Is=function(e,t,s){let i=document.createElement("div");return i.classList.add("treeselect-input"),i.setAttribute("tabindex","-1"),i.addEventListener("mousedown",n=>a(this,Ne,Rt).call(this,n)),i.addEventListener("focus",()=>this.focusCallback(),!0),i.addEventListener("blur",()=>this.blurCallback(),!0),e.appendChild(t),i.append(e,s),i},Ne=new WeakSet,Rt=function(e){e.stopPropagation(),this.isOpened||a(this,V,D).call(this),this.focus()},Ae=new WeakSet,$s=function(){let e=document.createElement("div");return e.classList.add("treeselect-input__tags"),e},Pe=new WeakSet,Ut=function(){return this.value.map(e=>{let t=document.createElement("div");t.classList.add("treeselect-input__tags-element"),t.setAttribute("tabindex","-1"),t.setAttribute("tag-id",e.id.toString()),t.setAttribute("title",e.name);let s=a(this,He,zt).call(this,e.name),i=a(this,Me,Yt).call(this);return t.addEventListener("mousedown",n=>a(this,Be,Ft).call(this,n,e.id)),t.append(s,i),t})},Be=new WeakSet,Ft=function(e,t){e.preventDefault(),e.stopPropagation(),this.removeItem(t),this.focus()},He=new WeakSet,zt=function(e){let t=document.createElement("span");return t.classList.add("treeselect-input__tags-name"),t.textContent=e,t},Me=new WeakSet,Yt=function(){let e=document.createElement("span");return e.classList.add("treeselect-input__tags-cross"),H(this.iconElements.cross,e),e},Ve=new WeakSet,Jt=function(){let e=document.createElement("span");if(e.classList.add("treeselect-input__tags-count"),!this.value.length)return e.textContent="",e.setAttribute("title",""),e;let t=this.value.length===1?this.value[0].name:`${this.value.length} ${this.tagsCountText}`;return e.textContent=t,e.setAttribute("title",t),e},Ge=new WeakSet,Ds=function(){let e=document.createElement("input");return e.classList.add("treeselect-input__edit"),this.id&&e.setAttribute("id",this.id),(!this.searchable||this.disabled)&&e.setAttribute("readonly","readonly"),this.disabled&&e.setAttribute("tabindex","-1"),this.ariaLabel.length&&e.setAttribute("aria-label",this.ariaLabel),e.addEventListener("keydown",t=>a(this,Ie,Kt).call(this,t)),e.addEventListener("input",t=>a(this,$e,Xt).call(this,t,e)),e},Ie=new WeakSet,Kt=function(e){e.stopPropagation();let t=e.key;t==="Backspace"&&!this.searchText.length&&this.value.length&&!this.showTags&&this.clear(),t==="Backspace"&&!this.searchText.length&&this.value.length&&this.removeItem(this.value[this.value.length-1].id),e.code==="Space"&&(!this.searchText||!this.searchable)&&a(this,V,D).call(this),(t==="Enter"||t==="ArrowDown"||t==="ArrowUp")&&e.preventDefault(),this.keydownCallback(e),t!=="Tab"&&this.focus()},$e=new WeakSet,Xt=function(e,t){e.stopPropagation();let s=this.searchText,i=t.value.trim();if(s.length===0&&i.length===0){t.value="";return}if(this.searchable){let n=e.target.value;this.searchCallback(n),this.isOpened||a(this,V,D).call(this)}else t.value="";this.searchText=t.value},De=new WeakSet,qs=function(){let e=document.createElement("div");return e.classList.add("treeselect-input__operators"),e},qe=new WeakSet,Qt=function(){let e=document.createElement("span");return e.classList.add("treeselect-input__clear"),e.setAttribute("tabindex","-1"),H(this.iconElements.clear,e),e.addEventListener("mousedown",t=>a(this,je,Zt).call(this,t)),e},je=new WeakSet,Zt=function(e){e.preventDefault(),e.stopPropagation(),(this.searchText.length||this.value.length)&&this.clear(),this.focus()},Re=new WeakSet,es=function(e){v(this,W,document.createElement("span")),l(this,W).classList.add("treeselect-input__arrow");let t=e?this.iconElements.arrowUp:this.iconElements.arrowDown;return H(t,l(this,W)),l(this,W).addEventListener("mousedown",s=>a(this,Ue,ts).call(this,s)),l(this,W)},Ue=new WeakSet,ts=function(e){e.stopPropagation(),e.preventDefault(),this.focus(),a(this,V,D).call(this)},se=new WeakSet,Fe=function(){this.inputCallback(this.value)};var js=(e,t,s,i)=>{wi(t);let n=t.filter(c=>!c.disabled&&e.some(r=>r===c.id));if(s&&n.length){n[0].checked=!0;return}n.forEach(c=>{c.checked=!0;let r=It(c,t,i);c.checked=r})},It=({id:e,checked:t},s,i)=>{let n=s.find(r=>r.id===e);if(!n)return!1;if(i)return n.checked=n.disabled?!1:!!t,n.checked;let c=Rs(!!t,n,s);return Us(n,s),c},Rs=(e,t,s)=>{if(!t.isGroup)return t.checked=t.disabled?!1:!!e,t.isPartialChecked=!1,t.checked;let i=s.filter(n=>n.childOf===t.id);return!e||t.disabled||t.isPartialChecked?(t.checked=!1,t.isPartialChecked=!1,Ye(t,i,s),t.checked):Fs(i,s)?zs(i)?(t.checked=!1,t.isPartialChecked=!1,t.disabled=!0,t.checked):(t.checked=!1,t.isPartialChecked=!0,i.forEach(n=>{Rs(e,n,s)}),t.checked):(t.checked=!0,t.isPartialChecked=!1,Ye(t,i,s),t.checked)},Us=(e,t)=>{let s=t.find(i=>i.id===e.childOf);s&&(mi(s,t),Us(s,t))},mi=(e,t)=>{let s=be(e,t);if(zs(s)){e.checked=!1,e.isPartialChecked=!1,e.disabled=!0;return}if(fi(s)){e.checked=!0,e.isPartialChecked=!1;return}if(ki(s)){e.checked=!1,e.isPartialChecked=!0;return}e.checked=!1,e.isPartialChecked=!1},Ye=({checked:e,disabled:t},s,i)=>{s.forEach(n=>{n.disabled=!!t||!!n.disabled,n.checked=!!e&&!n.disabled,n.isPartialChecked=!1;let c=be(n,i);Ye({checked:e,disabled:t},c,i)})},Fs=(e,t)=>e.some(s=>s.disabled)?!0:e.some(s=>{if(s.isGroup){let i=be(s,t);return Fs(i,t)}return!1}),zs=e=>e.every(t=>!!t.disabled),fi=e=>e.every(t=>!!t.checked),ki=e=>e.some(t=>!!t.checked||!!t.isPartialChecked),wi=e=>{e.forEach(t=>{t.checked=!1,t.isPartialChecked=!1})},vi=(e,t,s)=>{let i={level:0,groupId:""},n=Ys(e,t,i.groupId,i.level);return gi(n,s)},Ys=(e,t,s,i)=>e.reduce((n,c)=>{var r;let p=!!((r=c.children)!=null&&r.length),C=i>=t&&p,b=i>t;if(n.push({id:c.value,name:c.name,childOf:s,isGroup:p,checked:!1,isPartialChecked:!1,level:i,isClosed:C,hidden:b,disabled:c.disabled??!1}),p){let g=Ys(c.children,t,c.value,i+1);n.push(...g)}return n},[]),be=({id:e},t)=>t.filter(s=>s.childOf===e),bi=e=>{let{ungroupedNodes:t,allGroupedNodes:s,allNodes:i}=e.reduce((c,r)=>(r.checked&&(c.allNodes.push(r),r.isGroup?c.allGroupedNodes.push(r):c.ungroupedNodes.push(r)),c),{ungroupedNodes:[],allGroupedNodes:[],allNodes:[]}),n=i.filter(c=>!s.some(({id:r})=>r===c.childOf));return{ungroupedNodes:t,groupedNodes:n,allNodes:i}},gi=(e,t)=>(e.filter(s=>!!s.disabled).forEach(({id:s})=>It({id:s,checked:!1},e,t)),e),ge=(e,{id:t,isClosed:s})=>{be({id:t},e).forEach(i=>{i.hidden=s??!1,i.isGroup&&!i.isClosed&&ge(e,{id:i.id,isClosed:s})})},Ci=e=>{e.filter(t=>t.isGroup&&!t.disabled&&(t.checked||t.isPartialChecked)).forEach(t=>{t.isClosed=!1,ge(e,t)})},Ei=(e,t)=>{let s=Si(e,t);e.forEach(i=>{s.some(({id:n})=>n===i.id)?(i.isGroup&&(i.isClosed=!1,ge(e,i)),i.hidden=!1):i.hidden=!0})},Si=(e,t)=>e.reduce((s,i)=>{if(i.name.toLowerCase().includes(t.toLowerCase())){if(s.push(i),i.isGroup){let n=Js(i.id,e);s.push(...n)}if(i.childOf){let n=Ks(i.childOf,e);s.push(...n)}}return s},[]),Js=(e,t)=>t.reduce((s,i)=>(i.childOf===e&&(s.push(i),i.isGroup&&s.push(...Js(i.id,t))),s),[]),Ks=(e,t)=>t.reduce((s,i)=>(i.id===e&&(s.push(i),i.childOf&&s.push(...Ks(i.childOf,t))),s),[]),Li=e=>{let{duplications:t}=e.reduce((s,i)=>(s.allItems.some(n=>n.toString()===i.id.toString())&&s.duplications.push(i.id),s.allItems.push(i.id),s),{duplications:[],allItems:[]});t.length&&console.error(`Validation: You have duplicated values: ${t.join(", ")}! You should use unique values.`)},yi=(e,t,s,i,n,c,r,p,C,b)=>{js(e,t,n,C),p&&r&&Ci(t),pe(t,s,i,c,b)},pe=(e,t,s,i,n)=>{e.forEach(c=>{let r=t.querySelector(`[input-id="${c.id}"]`),p=P(r);r.checked=c.checked,xi(c,p,i),_i(c,p),Wi(c,p),Ti(c,p,s),Oi(c,p),Ai(c,p,e,n),Ni(c,r,s)}),Pi(e,t)},xi=(e,t,s)=>{e.checked?t.classList.add("treeselect-list__item--checked"):t.classList.remove("treeselect-list__item--checked"),Array.isArray(s)&&s[0]===e.id&&!e.disabled?t.classList.add("treeselect-list__item--single-selected"):t.classList.remove("treeselect-list__item--single-selected")},_i=(e,t)=>{e.isPartialChecked?t.classList.add("treeselect-list__item--partial-checked"):t.classList.remove("treeselect-list__item--partial-checked")},Wi=(e,t)=>{e.disabled?t.classList.add("treeselect-list__item--disabled"):t.classList.remove("treeselect-list__item--disabled")},Ti=(e,t,s)=>{if(e.isGroup){let i=t.querySelector(".treeselect-list__item-icon"),n=e.isClosed?s.arrowRight:s.arrowDown;H(n,i),e.isClosed?t.classList.add("treeselect-list__item--closed"):t.classList.remove("treeselect-list__item--closed")}},Oi=(e,t)=>{e.hidden?t.classList.add("treeselect-list__item--hidden"):t.classList.remove("treeselect-list__item--hidden")},Ni=(e,t,s)=>{let i=t.parentNode.querySelector(".treeselect-list__item-checkbox-icon");e.checked?H(s.check,i):e.isPartialChecked?H(s.partialCheck,i):i.innerHTML=""},Ai=(e,t,s,i)=>{let n=e.level===0,c=20,r=5;if(n){let p=s.some(g=>g.isGroup&&g.level===e.level),C=!e.isGroup&&p?`${c}px`:`${r}px`,b=e.isGroup?"0":C;i?t.style.paddingRight=b:t.style.paddingLeft=b}else{let p=e.isGroup?`${e.level*c}px`:`${e.level*c+c}px`;i?t.style.paddingRight=p:t.style.paddingLeft=p}t.setAttribute("level",e.level.toString()),t.setAttribute("group",e.isGroup.toString())},Pi=(e,t)=>{let s=e.some(n=>!n.hidden),i=t.querySelector(".treeselect-list__empty");s?i.classList.add("treeselect-list__empty--hidden"):i.classList.remove("treeselect-list__empty--hidden")},P=e=>e.parentNode.parentNode,ss=(e,t)=>t.find(s=>s.id.toString()===e),Bi=e=>P(e).querySelector(".treeselect-list__item-icon"),Hi=(e,t)=>{t&&Object.keys(t).forEach(s=>{let i=t[s];typeof i=="string"&&e.setAttribute(s,i)})},U,q,B,ie,Je,Xs,Ke,Qs,Xe,Zs,Qe,is,Ze,ls,et,ns,le,Ce,tt,as,st,hs,it,os,ne,Ee,lt,cs,nt,rs,at,ds,ht,us,ot,ps,ct,ms,rt,fs,dt,ks,ut,ws,pt,vs,mt,bs,ae,Se,me,ft,kt,gs,wt=class{constructor({options:t,value:s,openLevel:i,listSlotHtmlComponent:n,emptyText:c,isSingleSelect:r,iconElements:p,showCount:C,disabledBranchNode:b,expandSelected:g,isIndependentNodes:E,rtl:S,inputCallback:y,arrowClickCallback:O,mouseupCallback:x}){h(this,Je),h(this,Ke),h(this,Xe),h(this,Qe),h(this,Ze),h(this,et),h(this,le),h(this,tt),h(this,st),h(this,it),h(this,ne),h(this,lt),h(this,nt),h(this,at),h(this,ht),h(this,ot),h(this,ct),h(this,rt),h(this,dt),h(this,ut),h(this,pt),h(this,mt),h(this,ae),h(this,me),h(this,kt),o(this,"options"),o(this,"value"),o(this,"openLevel"),o(this,"listSlotHtmlComponent"),o(this,"emptyText"),o(this,"isSingleSelect"),o(this,"showCount"),o(this,"disabledBranchNode"),o(this,"expandSelected"),o(this,"isIndependentNodes"),o(this,"rtl"),o(this,"iconElements"),o(this,"searchText"),o(this,"flattedOptions"),o(this,"flattedOptionsBeforeSearch"),o(this,"selectedNodes"),o(this,"srcElement"),o(this,"inputCallback"),o(this,"arrowClickCallback"),o(this,"mouseupCallback"),h(this,U,null),h(this,q,!0),h(this,B,[]),h(this,ie,!0),this.options=t,this.value=s,this.openLevel=i??0,this.listSlotHtmlComponent=n??null,this.emptyText=c??"No results found...",this.isSingleSelect=r??!1,this.showCount=C??!1,this.disabledBranchNode=b??!1,this.expandSelected=g??!1,this.isIndependentNodes=E??!1,this.rtl=S??!1,this.iconElements=p,this.searchText="",this.flattedOptions=vi(this.options,this.openLevel,this.isIndependentNodes),this.flattedOptionsBeforeSearch=this.flattedOptions,this.selectedNodes={nodes:[],groupedNodes:[],allNodes:[]},this.srcElement=a(this,Xe,Zs).call(this),this.inputCallback=y,this.arrowClickCallback=O,this.mouseupCallback=x,Li(this.flattedOptions)}updateValue(t){this.value=t,v(this,B,this.isSingleSelect?this.value:[]),yi(t,this.flattedOptions,this.srcElement,this.iconElements,this.isSingleSelect,l(this,B),this.expandSelected,l(this,ie),this.isIndependentNodes,this.rtl),v(this,ie,!1),a(this,me,ft).call(this)}updateSearchValue(t){if(t===this.searchText)return;let s=this.searchText===""&&t!=="";this.searchText=t,s&&(this.flattedOptionsBeforeSearch=JSON.parse(JSON.stringify(this.flattedOptions))),this.searchText===""&&(this.flattedOptions=this.flattedOptionsBeforeSearch.map(i=>{let n=this.flattedOptions.find(c=>c.id===i.id);return n.isClosed=i.isClosed,n.hidden=i.hidden,n}),this.flattedOptionsBeforeSearch=[]),this.searchText&&Ei(this.flattedOptions,t),pe(this.flattedOptions,this.srcElement,this.iconElements,l(this,B),this.rtl),this.focusFirstListElement()}callKeyAction(t){v(this,q,!1);let s=this.srcElement.querySelector(".treeselect-list__item--focused");if(s?.classList.contains("treeselect-list__item--hidden"))return;let i=t.key;i==="Enter"&&s&&s.dispatchEvent(new Event("mousedown")),(i==="ArrowLeft"||i==="ArrowRight")&&a(this,Je,Xs).call(this,s,t),(i==="ArrowDown"||i==="ArrowUp")&&a(this,Ke,Qs).call(this,s,i)}focusFirstListElement(){let t="treeselect-list__item--focused",s=this.srcElement.querySelector(`.${t}`),i=Array.from(this.srcElement.querySelectorAll(".treeselect-list__item-checkbox")).filter(n=>window.getComputedStyle(P(n)).display!=="none");i.length&&(s&&s.classList.remove(t),P(i[0]).classList.add(t))}isLastFocusedElementExist(){return!!l(this,U)}};U=new WeakMap,q=new WeakMap,B=new WeakMap,ie=new WeakMap,Je=new WeakSet,Xs=function(e,t){if(!e)return;let s=t.key,i=e.querySelector(".treeselect-list__item-checkbox").getAttribute("input-id"),n=ss(i,this.flattedOptions),c=e.querySelector(".treeselect-list__item-icon");s==="ArrowLeft"&&!n.isClosed&&n.isGroup&&(c.dispatchEvent(new Event("mousedown")),t.preventDefault()),s==="ArrowRight"&&n.isClosed&&n.isGroup&&(c.dispatchEvent(new Event("mousedown")),t.preventDefault())},Ke=new WeakSet,Qs=function(e,t){var s;let i=Array.from(this.srcElement.querySelectorAll(".treeselect-list__item-checkbox")).filter(n=>window.getComputedStyle(P(n)).display!=="none");if(i.length)if(!e)P(i[0]).classList.add("treeselect-list__item--focused");else{let n=i.findIndex(y=>P(y).classList.contains("treeselect-list__item--focused"));P(i[n]).classList.remove("treeselect-list__item--focused");let c=t==="ArrowDown"?n+1:n-1,r=t==="ArrowDown"?0:i.length-1,p=i[c]??i[r],C=!i[c],b=P(p);b.classList.add("treeselect-list__item--focused");let g=this.srcElement.getBoundingClientRect(),E=b.getBoundingClientRect();if(C&&t==="ArrowDown"){this.srcElement.scroll(0,0);return}if(C&&t==="ArrowUp"){this.srcElement.scroll(0,this.srcElement.scrollHeight);return}let S=((s=this.listSlotHtmlComponent)==null?void 0:s.clientHeight)??0;if(g.y+g.height<E.y+E.height+S){this.srcElement.scroll(0,this.srcElement.scrollTop+E.height);return}if(g.y>E.y){this.srcElement.scroll(0,this.srcElement.scrollTop-E.height);return}}},Xe=new WeakSet,Zs=function(){let e=a(this,Qe,is).call(this),t=a(this,le,Ce).call(this,this.options);e.append(...t);let s=a(this,st,hs).call(this);e.append(s);let i=a(this,tt,as).call(this);return i&&e.append(i),e},Qe=new WeakSet,is=function(){let e=document.createElement("div");return e.classList.add("treeselect-list"),this.isSingleSelect&&e.classList.add("treeselect-list--single-select"),this.disabledBranchNode&&e.classList.add("treeselect-list--disabled-branch-node"),e.addEventListener("mouseout",t=>a(this,Ze,ls).call(this,t)),e.addEventListener("mousemove",()=>a(this,et,ns).call(this)),e.addEventListener("mouseup",()=>this.mouseupCallback(),!0),e},Ze=new WeakSet,ls=function(e){e.stopPropagation(),l(this,U)&&l(this,q)&&l(this,U).classList.add("treeselect-list__item--focused")},et=new WeakSet,ns=function(){v(this,q,!0)},le=new WeakSet,Ce=function(e){return e.reduce((t,s)=>{var i;if((i=s.children)!=null&&i.length){let c=a(this,it,os).call(this,s),r=a(this,le,Ce).call(this,s.children);return c.append(...r),t.push(c),t}let n=a(this,ne,Ee).call(this,s,!1);return t.push(n),t},[])},tt=new WeakSet,as=function(){if(!this.listSlotHtmlComponent)return null;let e=document.createElement("div");return e.classList.add("treeselect-list__slot"),e.appendChild(this.listSlotHtmlComponent),e},st=new WeakSet,hs=function(){let e=document.createElement("div");e.classList.add("treeselect-list__empty"),e.setAttribute("title",this.emptyText);let t=document.createElement("span");t.classList.add("treeselect-list__empty-icon"),H(this.iconElements.attention,t);let s=document.createElement("span");return s.classList.add("treeselect-list__empty-text"),s.textContent=this.emptyText,e.append(t,s),e},it=new WeakSet,os=function(e){let t=document.createElement("div");t.setAttribute("group-container-id",e.value.toString()),t.classList.add("treeselect-list__group-container");let s=a(this,ne,Ee).call(this,e,!0);return t.appendChild(s),t},ne=new WeakSet,Ee=function(e,t){let s=a(this,lt,cs).call(this,e);if(t){let c=a(this,ot,ps).call(this);s.appendChild(c),s.classList.add("treeselect-list__item--group")}let i=a(this,rt,fs).call(this,e),n=a(this,dt,ks).call(this,e,t);return s.append(i,n),s},lt=new WeakSet,cs=function(e){let t=document.createElement("div");return Hi(t,e.htmlAttr),t.setAttribute("tabindex","-1"),t.setAttribute("title",e.name),t.classList.add("treeselect-list__item"),t.addEventListener("mouseover",()=>a(this,nt,rs).call(this,t),!0),t.addEventListener("mouseout",()=>a(this,at,ds).call(this,t),!0),t.addEventListener("mousedown",s=>a(this,ht,us).call(this,s,e)),t},nt=new WeakSet,rs=function(e){l(this,q)&&a(this,ae,Se).call(this,!0,e)},at=new WeakSet,ds=function(e){l(this,q)&&(a(this,ae,Se).call(this,!1,e),v(this,U,e))},ht=new WeakSet,us=function(e,t){var s;if(e.preventDefault(),e.stopPropagation(),(s=this.flattedOptions.find(n=>n.id===t.value))==null?void 0:s.disabled)return;let i=e.target.querySelector(".treeselect-list__item-checkbox");i.checked=!i.checked,a(this,pt,vs).call(this,i,t)},ot=new WeakSet,ps=function(){let e=document.createElement("span");return e.setAttribute("tabindex","-1"),e.classList.add("treeselect-list__item-icon"),H(this.iconElements.arrowDown,e),e.addEventListener("mousedown",t=>a(this,ct,ms).call(this,t)),e},ct=new WeakSet,ms=function(e){e.preventDefault(),e.stopPropagation(),a(this,mt,bs).call(this,e)},rt=new WeakSet,fs=function(e){let t=document.createElement("div");t.classList.add("treeselect-list__item-checkbox-container");let s=document.createElement("span");s.classList.add("treeselect-list__item-checkbox-icon"),s.innerHTML="";let i=document.createElement("input");return i.setAttribute("tabindex","-1"),i.setAttribute("type","checkbox"),i.setAttribute("input-id",e.value.toString()),i.classList.add("treeselect-list__item-checkbox"),t.append(s,i),t},dt=new WeakSet,ks=function(e,t){let s=document.createElement("label");if(s.textContent=e.name,s.classList.add("treeselect-list__item-label"),t&&this.showCount){let i=a(this,ut,ws).call(this,e);s.appendChild(i)}return s},ut=new WeakSet,ws=function(e){let t=document.createElement("span"),s=this.flattedOptions.filter(i=>i.childOf===e.value);return t.textContent=`(${s.length})`,t.classList.add("treeselect-list__item-label-counter"),t},pt=new WeakSet,vs=function(e,t){let s=this.flattedOptions.find(i=>i.id===t.value);if(s){if(s!=null&&s.isGroup&&this.disabledBranchNode){let i=Bi(e);i?.dispatchEvent(new Event("mousedown"));return}if(this.isSingleSelect){let[i]=l(this,B);if(s.id===i)return;v(this,B,[s.id]),js([s.id],this.flattedOptions,this.isSingleSelect,this.isIndependentNodes)}else{s.checked=e.checked;let i=It(s,this.flattedOptions,this.isIndependentNodes);e.checked=i}pe(this.flattedOptions,this.srcElement,this.iconElements,l(this,B),this.rtl),a(this,kt,gs).call(this)}},mt=new WeakSet,bs=function(e){var t,s;let i=(s=(t=e.target)==null?void 0:t.parentNode)==null?void 0:s.querySelector("[input-id]"),n=i?.getAttribute("input-id")??null,c=ss(n,this.flattedOptions);c&&(c.isClosed=!c.isClosed,ge(this.flattedOptions,c),pe(this.flattedOptions,this.srcElement,this.iconElements,l(this,B),this.rtl),this.arrowClickCallback(c.id,c.isClosed))},ae=new WeakSet,Se=function(e,t){let s="treeselect-list__item--focused";if(e){let i=Array.from(this.srcElement.querySelectorAll(`.${s}`));i.length&&i.forEach(n=>n.classList.remove(s)),t.classList.add(s)}else t.classList.remove(s)},me=new WeakSet,ft=function(){let{ungroupedNodes:e,groupedNodes:t,allNodes:s}=bi(this.flattedOptions);this.selectedNodes={nodes:e,groupedNodes:t,allNodes:s}},kt=new WeakSet,gs=function(){a(this,me,ft).call(this),this.inputCallback(this.selectedNodes),this.value=this.selectedNodes.nodes.map(e=>e.id)};var Cs=({parentHtmlContainer:e,staticList:t,appendToBody:s,isSingleSelect:i,value:n,direction:c})=>{e||console.error("Validation: parentHtmlContainer prop is required!"),t&&s&&console.error("Validation: You should set staticList to false if you use appendToBody!"),i&&Array.isArray(n)&&console.error("Validation: if you use isSingleSelect prop, you should pass a single value!"),!i&&!Array.isArray(n)&&console.error("Validation: you should pass an array as a value!"),c&&c!=="auto"&&c!=="bottom"&&c!=="top"&&console.error("Validation: you should pass (auto | top | bottom | undefined) as a value for the direction prop!")},te=e=>e.map(t=>t.id),Mi=e=>e?Array.isArray(e)?e:[e]:[],Vi=(e,t)=>{if(t){let[s]=e;return s??null}return e},u,k,J,he,K,N,A,_,$,oe,vt,ce,Le,bt,Es,gt,Ss,Ct,Ls,Et,ys,St,xs,Lt,_s,fe,yt,xt,Ws,_t,Ts,Wt,Os,Tt,Ns,ke,Ot,Nt,ei,ee,we,re,ye,X,de,At,As,ue,xe,Pt,Ps,Bt,Bs,Ht,Hs,Mt,Ms,Vt,Vs,ve=class{constructor({parentHtmlContainer:t,value:s,options:i,openLevel:n,appendToBody:c,alwaysOpen:r,showTags:p,tagsCountText:C,clearable:b,searchable:g,placeholder:E,grouped:S,isGroupedValue:y,listSlotHtmlComponent:O,disabled:x,emptyText:z,staticList:G,id:Y,ariaLabel:m,isSingleSelect:f,showCount:d,disabledBranchNode:w,direction:L,expandSelected:I,saveScrollPosition:ti,isIndependentNodes:si,rtl:ii,iconElements:li,inputCallback:ni,openCallback:ai,closeCallback:hi,nameChangeCallback:oi,searchCallback:ci,openCloseGroupCallback:ri}){h(this,oe),h(this,ce),h(this,bt),h(this,gt),h(this,Ct),h(this,Et),h(this,St),h(this,Lt),h(this,fe),h(this,xt),h(this,_t),h(this,Wt),h(this,Tt),h(this,ke),h(this,Nt),h(this,ee),h(this,re),h(this,X),h(this,At),h(this,ue),h(this,Pt),h(this,Bt),h(this,Ht),h(this,Mt),h(this,Vt),o(this,"parentHtmlContainer"),o(this,"value"),o(this,"options"),o(this,"openLevel"),o(this,"appendToBody"),o(this,"alwaysOpen"),o(this,"showTags"),o(this,"tagsCountText"),o(this,"clearable"),o(this,"searchable"),o(this,"placeholder"),o(this,"grouped"),o(this,"isGroupedValue"),o(this,"listSlotHtmlComponent"),o(this,"disabled"),o(this,"emptyText"),o(this,"staticList"),o(this,"id"),o(this,"ariaLabel"),o(this,"isSingleSelect"),o(this,"showCount"),o(this,"disabledBranchNode"),o(this,"direction"),o(this,"expandSelected"),o(this,"saveScrollPosition"),o(this,"isIndependentNodes"),o(this,"rtl"),o(this,"iconElements"),o(this,"inputCallback"),o(this,"openCallback"),o(this,"closeCallback"),o(this,"nameChangeCallback"),o(this,"searchCallback"),o(this,"openCloseGroupCallback"),o(this,"ungroupedValue"),o(this,"groupedValue"),o(this,"allValue"),o(this,"isListOpened"),o(this,"selectedName"),o(this,"srcElement"),h(this,u,null),h(this,k,null),h(this,J,null),h(this,he,0),h(this,K,0),h(this,N,null),h(this,A,null),h(this,_,null),h(this,$,null),Cs({parentHtmlContainer:t,value:s,staticList:G,appendToBody:c,isSingleSelect:f}),this.parentHtmlContainer=t,this.value=[],this.options=i??[],this.openLevel=n??0,this.appendToBody=c??!1,this.alwaysOpen=!!(r&&!x),this.showTags=p??!0,this.tagsCountText=C??"elements selected",this.clearable=b??!0,this.searchable=g??!0,this.placeholder=E??"Search...",this.grouped=S??!0,this.isGroupedValue=y??!1,this.listSlotHtmlComponent=O??null,this.disabled=x??!1,this.emptyText=z??"No results found...",this.staticList=!!(G&&!this.appendToBody),this.id=Y??"",this.ariaLabel=m??"",this.isSingleSelect=f??!1,this.showCount=d??!1,this.disabledBranchNode=w??!1,this.direction=L??"auto",this.expandSelected=I??!1,this.saveScrollPosition=ti??!0,this.isIndependentNodes=si??!1,this.rtl=ii??!1,this.iconElements=Dt(li),this.inputCallback=ni,this.openCallback=ai,this.closeCallback=hi,this.nameChangeCallback=oi,this.searchCallback=ci,this.openCloseGroupCallback=ri,this.ungroupedValue=[],this.groupedValue=[],this.allValue=[],this.isListOpened=!1,this.selectedName="",this.srcElement=null,a(this,oe,vt).call(this,s)}mount(){Cs({parentHtmlContainer:this.parentHtmlContainer,value:this.value,staticList:this.staticList,appendToBody:this.appendToBody,isSingleSelect:this.isSingleSelect}),this.iconElements=Dt(this.iconElements),a(this,oe,vt).call(this,this.value)}updateValue(t){let s=Mi(t),i=l(this,u);i&&(i.updateValue(s),a(this,fe,yt).call(this,i?.selectedNodes))}destroy(){this.srcElement&&(a(this,ke,Ot).call(this),this.srcElement.innerHTML="",this.srcElement=null,a(this,X,de).call(this,!0))}focus(){l(this,k)&&l(this,k).focus()}toggleOpenClose(){l(this,k)&&(l(this,k).openClose(),l(this,k).focus())}scrollWindowHandler(){this.updateListPosition()}focusWindowHandler(t){var s,i,n;(s=this.srcElement)!=null&&s.contains(t.target)||(i=l(this,u))!=null&&i.srcElement.contains(t.target)||((n=l(this,k))==null||n.blur(),a(this,X,de).call(this,!1),a(this,ee,we).call(this,!1))}blurWindowHandler(){var t;(t=l(this,k))==null||t.blur(),a(this,X,de).call(this,!1),a(this,ee,we).call(this,!1)}updateListPosition(){var t;let s=this.srcElement,i=(t=l(this,u))==null?void 0:t.srcElement;if(!s||!i)return;let{height:n}=i.getBoundingClientRect(),{x:c,y:r,height:p,width:C}=s.getBoundingClientRect(),b=window.innerHeight,g=r,E=b-r-p,S=g>E&&g>=n&&E<n;if(this.direction!=="auto"&&(S=this.direction==="top"),this.appendToBody){(i.style.top!=="0px"||i.style.left!=="0px")&&(i.style.top="0px",i.style.left="0px");let O=c+window.scrollX,x=S?r+window.scrollY-n:r+window.scrollY+p;i.style.transform=`translate(${O}px,${x}px)`,i.style.width=`${C}px`}let y=S?"top":"bottom";i.getAttribute("direction")!==y&&(i.setAttribute("direction",y),a(this,Nt,ei).call(this,S,this.appendToBody))}};u=new WeakMap,k=new WeakMap,J=new WeakMap,he=new WeakMap,K=new WeakMap,N=new WeakMap,A=new WeakMap,_=new WeakMap,$=new WeakMap,oe=new WeakSet,vt=function(e){var t;this.destroy();let{container:s,list:i,input:n}=a(this,bt,Es).call(this);this.srcElement=s,v(this,u,i),v(this,k,n),v(this,N,this.scrollWindowHandler.bind(this)),v(this,A,this.scrollWindowHandler.bind(this)),v(this,_,this.focusWindowHandler.bind(this)),v(this,$,this.blurWindowHandler.bind(this)),this.alwaysOpen&&((t=l(this,k))==null||t.openClose()),this.disabled?this.srcElement.classList.add("treeselect--disabled"):this.srcElement.classList.remove("treeselect--disabled"),this.updateValue(e??this.value)},ce=new WeakSet,Le=function({groupedNodes:e,nodes:t,allNodes:s}){this.ungroupedValue=t?te(t):[],this.groupedValue=e?te(e):[],this.allValue=s?te(s):[];let i=[];this.isIndependentNodes||this.isSingleSelect?i=this.allValue:this.isGroupedValue?i=this.groupedValue:i=this.ungroupedValue,this.value=Vi(i,this.isSingleSelect)},bt=new WeakSet,Es=function(){let e=this.parentHtmlContainer;e.classList.add("treeselect"),this.rtl&&e.setAttribute("dir","rtl");let t=new wt({value:[],options:this.options,openLevel:this.openLevel,listSlotHtmlComponent:this.listSlotHtmlComponent,emptyText:this.emptyText,isSingleSelect:this.isSingleSelect,showCount:this.showCount,disabledBranchNode:this.disabledBranchNode,expandSelected:this.expandSelected,isIndependentNodes:this.isIndependentNodes,rtl:this.rtl,iconElements:this.iconElements,inputCallback:i=>a(this,xt,Ws).call(this,i),arrowClickCallback:(i,n)=>a(this,_t,Ts).call(this,i,n),mouseupCallback:()=>{var i;return(i=l(this,k))==null?void 0:i.focus()}}),s=new ze({value:[],showTags:this.showTags,tagsCountText:this.tagsCountText,clearable:this.clearable,isAlwaysOpened:this.alwaysOpen,searchable:this.searchable,placeholder:this.placeholder,disabled:this.disabled,isSingleSelect:this.isSingleSelect,id:this.id,ariaLabel:this.ariaLabel,iconElements:this.iconElements,inputCallback:i=>a(this,gt,Ss).call(this,i),searchCallback:i=>a(this,Et,ys).call(this,i),openCallback:()=>a(this,Tt,Ns).call(this),closeCallback:()=>a(this,ke,Ot).call(this),keydownCallback:i=>a(this,Ct,Ls).call(this,i),focusCallback:()=>a(this,St,xs).call(this),blurCallback:()=>a(this,Lt,_s).call(this),nameChangeCallback:i=>a(this,Wt,Os).call(this,i)});return this.appendToBody&&v(this,J,new ResizeObserver(()=>this.updateListPosition())),e.append(s.srcElement),{container:e,list:t,input:s}},gt=new WeakSet,Ss=function(e){var t,s;let i=te(e);(t=l(this,u))==null||t.updateValue(i);let n=((s=l(this,u))==null?void 0:s.selectedNodes)??{};a(this,ce,Le).call(this,n),a(this,ue,xe).call(this)},Ct=new WeakSet,Ls=function(e){var t;this.isListOpened&&((t=l(this,u))==null||t.callKeyAction(e))},Et=new WeakSet,ys=function(e){l(this,K)&&clearTimeout(l(this,K)),v(this,K,window.setTimeout(()=>{var t;(t=l(this,u))==null||t.updateSearchValue(e),this.updateListPosition()},350)),a(this,Mt,Ms).call(this,e)},St=new WeakSet,xs=function(){a(this,ee,we).call(this,!0),l(this,_)&&l(this,_)&&l(this,$)&&(document.addEventListener("mousedown",l(this,_),!0),document.addEventListener("focus",l(this,_),!0),window.addEventListener("blur",l(this,$)))},Lt=new WeakSet,_s=function(){setTimeout(()=>{var e,t;let s=(e=l(this,k))==null?void 0:e.srcElement.contains(document.activeElement),i=(t=l(this,u))==null?void 0:t.srcElement.contains(document.activeElement);!s&&!i&&this.blurWindowHandler()},1)},fe=new WeakSet,yt=function(e){var t;if(!e)return;let s=[];this.isIndependentNodes||this.isSingleSelect?s=e.allNodes:this.grouped?s=e.groupedNodes:s=e.nodes,(t=l(this,k))==null||t.updateValue(s),a(this,ce,Le).call(this,e)},xt=new WeakSet,Ws=function(e){var t,s,i;a(this,fe,yt).call(this,e),this.isSingleSelect&&!this.alwaysOpen&&((t=l(this,k))==null||t.openClose(),(s=l(this,k))==null||s.clearSearch()),(i=l(this,k))==null||i.focus(),a(this,ue,xe).call(this)},_t=new WeakSet,Ts=function(e,t){var s;(s=l(this,k))==null||s.focus(),this.updateListPosition(),a(this,Vt,Vs).call(this,e,t)},Wt=new WeakSet,Os=function(e){this.selectedName!==e&&(this.selectedName=e,a(this,Pt,Ps).call(this))},Tt=new WeakSet,Ns=function(){var e;this.isListOpened=!0,l(this,N)&&l(this,A)&&(window.addEventListener("scroll",l(this,N),!0),window.addEventListener("resize",l(this,A))),!(!l(this,u)||!this.srcElement)&&(this.appendToBody?(document.body.appendChild(l(this,u).srcElement),(e=l(this,J))==null||e.observe(this.srcElement)):this.srcElement.appendChild(l(this,u).srcElement),this.updateListPosition(),a(this,re,ye).call(this,!0),a(this,At,As).call(this),a(this,Bt,Bs).call(this))},ke=new WeakSet,Ot=function(){var e;this.alwaysOpen||(this.isListOpened=!1,l(this,N)&&l(this,A)&&(window.removeEventListener("scroll",l(this,N),!0),window.removeEventListener("resize",l(this,A))),!l(this,u)||!this.srcElement)||!(this.appendToBody?document.body.contains(l(this,u).srcElement):this.srcElement.contains(l(this,u).srcElement))||(v(this,he,l(this,u).srcElement.scrollTop),this.appendToBody?(document.body.removeChild(l(this,u).srcElement),(e=l(this,J))==null||e.disconnect()):this.srcElement.removeChild(l(this,u).srcElement),a(this,re,ye).call(this,!1),a(this,Ht,Hs).call(this))},Nt=new WeakSet,ei=function(e,t){if(!l(this,u)||!l(this,k))return;let s=t?"treeselect-list--top-to-body":"treeselect-list--top",i=t?"treeselect-list--bottom-to-body":"treeselect-list--bottom";e?(l(this,u).srcElement.classList.add(s),l(this,u).srcElement.classList.remove(i),l(this,k).srcElement.classList.add("treeselect-input--top"),l(this,k).srcElement.classList.remove("treeselect-input--bottom")):(l(this,u).srcElement.classList.remove(s),l(this,u).srcElement.classList.add(i),l(this,k).srcElement.classList.remove("treeselect-input--top"),l(this,k).srcElement.classList.add("treeselect-input--bottom"))},ee=new WeakSet,we=function(e){!l(this,k)||!l(this,u)||(e?(l(this,k).srcElement.classList.add("treeselect-input--focused"),l(this,u).srcElement.classList.add("treeselect-list--focused")):(l(this,k).srcElement.classList.remove("treeselect-input--focused"),l(this,u).srcElement.classList.remove("treeselect-list--focused")))},re=new WeakSet,ye=function(e){var t,s,i,n;e?(t=l(this,k))==null||t.srcElement.classList.add("treeselect-input--opened"):(s=l(this,k))==null||s.srcElement.classList.remove("treeselect-input--opened"),this.staticList?(i=l(this,u))==null||i.srcElement.classList.add("treeselect-list--static"):(n=l(this,u))==null||n.srcElement.classList.remove("treeselect-list--static")},X=new WeakSet,de=function(e){!l(this,N)||!l(this,A)||!l(this,_)||!l(this,$)||((!this.alwaysOpen||e)&&(window.removeEventListener("scroll",l(this,N),!0),window.removeEventListener("resize",l(this,A))),document.removeEventListener("mousedown",l(this,_),!0),document.removeEventListener("focus",l(this,_),!0),window.removeEventListener("blur",l(this,$)))},At=new WeakSet,As=function(){var e,t,s;let i=(e=l(this,u))==null?void 0:e.isLastFocusedElementExist();this.saveScrollPosition&&i?(t=l(this,u))==null||t.srcElement.scroll(0,l(this,he)):(s=l(this,u))==null||s.focusFirstListElement()},ue=new WeakSet,xe=function(){var e;(e=this.srcElement)==null||e.dispatchEvent(new CustomEvent("input",{detail:this.value})),this.inputCallback&&this.inputCallback(this.value)},Pt=new WeakSet,Ps=function(){var e;(e=this.srcElement)==null||e.dispatchEvent(new CustomEvent("name-change",{detail:this.selectedName})),this.nameChangeCallback&&this.nameChangeCallback(this.selectedName)},Bt=new WeakSet,Bs=function(){var e;this.alwaysOpen||((e=this.srcElement)==null||e.dispatchEvent(new CustomEvent("open",{detail:this.value})),this.openCallback&&this.openCallback(this.value))},Ht=new WeakSet,Hs=function(){var e;this.alwaysOpen||((e=this.srcElement)==null||e.dispatchEvent(new CustomEvent("close",{detail:this.value})),this.closeCallback&&this.closeCallback(this.value))},Mt=new WeakSet,Ms=function(e){var t;let s=e?.trim()??"";(t=this.srcElement)==null||t.dispatchEvent(new CustomEvent("search",{detail:s})),this.searchCallback&&this.searchCallback(s)},Vt=new WeakSet,Vs=function(e,t){var s;(s=this.srcElement)==null||s.dispatchEvent(new CustomEvent("open-close-group",{detail:{groupId:e,isClosed:t}})),this.openCloseGroupCallback&&this.openCloseGroupCallback(e,t)};function Gi({state:e,name:t,options:s,searchable:i,showCount:n,placeholder:c,rtl:r,disabledBranchNode:p=!0,disabled:C=!1,isSingleSelect:b=!0,showTags:g=!0,clearable:E=!0,isIndependentNodes:S=!0,alwaysOpen:y=!1,emptyText:O,expandSelected:x=!0,grouped:z=!0,openLevel:G=0,direction:Y="auto"}){return{state:e,tree:null,nodeMap:{},flatOptions:[],buildNodeMap(m,f=""){Array.isArray(m)&&m.forEach(d=>{let w=d.value;this.flatOptions.push({value:w,parent:d.parent||f,hasChildren:Array.isArray(d.children)&&d.children.length>0}),this.nodeMap[w]={parent:d.parent||f,value:w},Array.isArray(d.children)&&d.children.length>0&&this.buildNodeMap(d.children,w)})},getParentPaths(m){let f=[];if(typeof m=="string"&&m.includes(".")){let w=m.split(".");for(let L=1;L<w.length;L++)f.push(w.slice(0,L).join("."));return f}let d=m;for(;this.nodeMap[d]&&this.nodeMap[d].parent;){let w=this.nodeMap[d].parent;w&&f.push(w),d=w}return f},getValuesToExpand(){let m=Array.isArray(this.state)?this.state:this.state?[this.state]:[];if(m.length===0)return[];let f=new Set;return m.forEach(d=>{this.getParentPaths(d).forEach(L=>{f.add(L)});let w=this.flatOptions.find(L=>L.value===d);w&&w.hasChildren&&f.add(d)}),Array.from(f)},findExpandableElements(){let m=this.getValuesToExpand();if(!m.length)return[];let f=[];return m.forEach(d=>{let w=[`[data-value="${d}"]`,`[data-id="${d}"]`,`[data-path="${d}"]`,`.node[data-value="${d}"]`,`.ts-node[data-value="${d}"]`,`.treeselectjs-option[data-value="${d}"]`];for(let L of w){let I=Array.from(this.tree.srcElement.querySelectorAll(L));if(I.length){f.push(...I);break}}}),f},expandNodeElement(m){if(m)try{let f=[".toggle",".expander",".collapse-icon",".ts-toggle",".treeselectjs-toggle","button.collapse",'[role="button"]',".arrow",".expand-icon"],d=m.closest(".ts-node, .treeselectjs-option, .node, .branch");if(!d)return;let w=null;for(let L of f){let I=d.querySelector(L);if(I){w=I;break}}w&&(w.classList.contains("collapsed")||w.classList.contains("closed")||w.getAttribute("aria-expanded")==="false"||!d.classList.contains("expanded"))&&w.click(),w||d.dispatchEvent(new CustomEvent("ts-expand",{bubbles:!0}))}catch(f){console.error("Error expanding node element:",f)}},expandPathsToSelected(){if(!this.tree||!x)return;let m=this.findExpandableElements();m.length!==0&&(m.sort((f,d)=>f.compareDocumentPosition(d)&Node.DOCUMENT_POSITION_FOLLOWING?-1:1),m.forEach(f=>{this.expandNodeElement(f)}),typeof this.tree.expandPaths=="function"&&this.tree.expandPaths(this.getValuesToExpand()),m.length>0&&G===0&&this.tree.openLevel!==void 0&&(this.tree.openLevel=5))},init(){this.nodeMap={},this.flatOptions=[],this.buildNodeMap(s),this.tree=new ve({id:`tree-${t}-id`,ariaLabel:`tree-${t}-label`,parentHtmlContainer:this.$refs.tree,value:this.state,options:s,searchable:i,showCount:n,placeholder:c,disabledBranchNode:p,disabled:C,isSingleSelect:b,showTags:g,clearable:E,isIndependentNodes:S,alwaysOpen:y,emptyText:O,expandSelected:x,grouped:z,openLevel:G,direction:Y,rtl:r}),this.tree.srcElement.addEventListener("input",m=>{this.state=m.detail,setTimeout(()=>this.expandPathsToSelected(),50)}),this.tree.srcElement.addEventListener("open",()=>{setTimeout(()=>this.expandPathsToSelected(),100)}),["ts-open","show","shown","dropdown-open"].forEach(m=>{this.tree.srcElement.addEventListener(m,()=>{setTimeout(()=>this.expandPathsToSelected(),100)})}),this.state&&(setTimeout(()=>this.expandPathsToSelected(),100),setTimeout(()=>this.expandPathsToSelected(),500))}}}export{Gi as default};
